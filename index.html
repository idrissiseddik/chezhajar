<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Boutique Marocain - Amlou & Miel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- BOOTSTRAP -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- FONT AWESOME -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

<!-- SWEETALERT2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');

:root{
--vert:#0f7c4a;
--or:#c9a24d;
--beige:#f6f1e7;
}

body{
font-family:'Cairo',sans-serif;
background:var(--beige);
padding-top:80px;
padding-bottom:80px;
}

header,footer{
position:fixed;
width:100%;
z-index:1000;
background:
repeating-linear-gradient(
45deg,
var(--vert),
var(--vert) 10px,
#0c6b40 10px,
#0c6b40 20px
);
color:#fff;
}

header{top:0}
footer{bottom:0}

.card{
border:3px solid var(--or);
border-radius:20px;
box-shadow:0 10px 20px rgba(0,0,0,.15);
}

.card img{
height:180px;
object-fit:cover;
border-bottom:3px solid var(--or);
}

.qty{
width:50px;
text-align:center;
border-radius:20px;
border:2px solid var(--vert);
margin:0 5px;
}

.qty-container{
display:flex;
justify-content:center;
align-items:center;
gap:5px;
}

.badge{
background:var(--or)!important;
color:#000;
}

.remove{
cursor:pointer;
color:#b02a37;
font-size:18px;
}

.offcanvas a{
color:var(--vert);
}

.offcanvas a:hover{
color:var(--or);
transform:scale(1.2);
}

/* Panier Swal2 : produit sur 2 lignes */
.swal2-html-container .cart-item {
    display:flex;
    flex-direction:column;
    border-bottom:1px solid #ddd;
    padding:5px 0;
}

.swal2-html-container .cart-item-top {
    display:flex;
    align-items:center;
    gap:10px;
    margin-bottom:5px;
}

.swal2-html-container .cart-item-top img {
    width:50px;
    height:50px;
    object-fit:cover;
    border-radius:6px;
}

.swal2-html-container .cart-item-bottom {
    display:flex;
    align-items:center;
    justify-content:space-between;
}

.swal2-html-container .cart-item-bottom input[type="number"] {
    width:50px;
    text-align:center;
}

.swal2-html-container .qty-btn{
    cursor:pointer;
    padding:2px 6px;
    border-radius:4px;
    border:1px solid #0f7c4a;
    background:#f6f1e7;
    margin:0 2px;
}
</style>
</head>

<body>

<!-- HEADER -->
<header class="p-3 d-flex justify-content-between align-items-center">
<button class="btn btn-light" data-bs-toggle="offcanvas" data-bs-target="#menu">
<i class="fa fa-bars"></i>
</button>

<h5 class="m-0">Produits Marocains üá≤üá¶</h5>

<button class="btn btn-light position-relative" onclick="openCart()">
<i class="fa fa-shopping-cart"></i>
<span class="badge position-absolute top-0 start-100 translate-middle" id="cartCount">0</span>
</button>
</header>

<!-- OFFCANVAS -->
<div class="offcanvas offcanvas-start" id="menu">
<div class="offcanvas-header">
<h5>Menu</h5>
<button class="btn-close" data-bs-dismiss="offcanvas"></button>
</div>

<div class="offcanvas-body d-flex flex-column justify-content-between">

<div>
<p class="fw-bold">Terroir marocain authentique</p>
<p>Amlou ‚Äì Miel ‚Äì Produits naturels</p>
</div>

<div class="border-top pt-3 text-center">
<div class="fw-bold mb-2">Contact direct</div>
<div class="d-flex justify-content-center gap-4 fs-4">
<a href="tel:+212661906684"><i class="fa fa-phone"></i></a>
<a href="https://wa.me/212661906684" target="_blank"><i class="fab fa-whatsapp"></i></a>
<a href="sms:+212661906684"><i class="fa fa-comment-dots"></i></a>
</div>
<div class="small mt-2">
+212 6 61 90 66 84
</div>
</div>

</div>
</div>

<!-- PRODUITS -->
<div class="container mt-4">
<div class="row" id="products"></div>
</div>

<!-- FOOTER -->
<footer class="text-center p-2">
¬© Boutique Marocaine
</footer>

<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
/* PRODUITS */
const products = [
{ id:1, name:"Amlou Amandes", price:50, image:"https://via.placeholder.com/300?text=Amlou" },
{ id:2, name:"Miel Naturel", price:70, image:"https://via.placeholder.com/300?text=Miel" },
{ id:3, name:"Huile d'Argan", price:90, image:"https://via.placeholder.com/300?text=Argan" }
];

let cart = [];

/* RENDRE LES PRODUITS */
function renderProducts(){
let html='';
products.forEach(p=>{
html+=`
<div class="col-md-4 mb-4">
<div class="card text-center p-3">
<img src="${p.image}">
<h5 class="mt-2">${p.name}</h5>
<p class="fw-bold">${p.price} DH</p>

<div class="qty-container">
<button class="btn btn-outline-success btn-sm" onclick="changeCardQty(${p.id},-1)">-</button>
<input type="number" min="1" value="1" class="qty" id="qty${p.id}">
<button class="btn btn-outline-success btn-sm" onclick="changeCardQty(${p.id},1)">+</button>
</div>

<button class="btn btn-success mt-2" onclick="addToCart(${p.id})">
<i class="fa fa-cart-plus"></i> Ajouter au panier
</button>
</div>
</div>`;
});
document.getElementById('products').innerHTML=html;
}

/* MODIFIER QUANTIT√â DANS CARTE */
function changeCardQty(id,delta){
let input=document.getElementById('qty'+id);
let val=parseInt(input.value)+delta;
if(val<1) val=1;
input.value=val;
}

/* AJOUTER AU PANIER */
function addToCart(id){
let qty=parseInt(document.getElementById('qty'+id).value);
let item=cart.find(i=>i.id===id);
if(item){
Swal.fire('D√©j√† ajout√©','Ce produit est d√©j√† dans le panier','info');
return;
}
let p=products.find(p=>p.id===id);
cart.push({...p,qty});
updateBadge();
Swal.fire('Ajout√©','Produit ajout√© au panier','success');
}

/* METTRE A JOUR LE BADGE */
function updateBadge(){
document.getElementById('cartCount').innerText=
cart.reduce((a,b)=>a+b.qty,0);
}

/* OUVRIR PANIER */
function openCart(){
if(cart.length===0){
Swal.fire('Panier vide','','info');
return;
}

let total=cart.reduce((a,b)=>a+b.price*b.qty,0);
let itemsHtml='';
cart.forEach((i,idx)=>{
itemsHtml+=`
<div class="cart-item">
  <div class="cart-item-top">
    <img src="${i.image}" alt="${i.name}">
    <span>${i.name}</span>
  </div>
  <div class="cart-item-bottom">
    <div>
      <button class="qty-btn" onclick="changeQty(${idx},-1)">-</button>
      <input type="number" min="1" value="${i.qty}" onchange="changeQtyInput(${idx},this.value)">
      <button class="qty-btn" onclick="changeQty(${idx},1)">+</button>
    </div>
    <div>${i.price*i.qty} DH</div>
    <div><i class="fa fa-trash remove" onclick="confirmRemove(${idx})"></i></div>
  </div>
</div>`;
});

Swal.fire({
title:'Votre panier',
html:`
${itemsHtml}
<select id="livraison" class="form-select mb-2" onchange="updateTotal()">
<option value="0">Sans livraison</option>
<option value="10">Avec livraison (+10 DH)</option>
</select>

<p>Total: <b><span id="total">${total}</span> DH</b></p>

<input id="nom" class="form-control mb-2" placeholder="Nom *">
<input id="adresse" class="form-control mb-2" placeholder="Adresse *">
<input id="tel" class="form-control mb-2" placeholder="T√©l√©phone *">
<textarea id="comment" class="form-control" placeholder="Commentaire (optionnel)"></textarea>
`,
showCancelButton:true,
confirmButtonText:'Commander via WhatsApp',
cancelButtonText:'Continuer mes achats',
preConfirm:sendOrder
}).then((result)=>{
if(result.isDismissed){ renderProducts(); }
});
}

/* CHANGER QUANTIT√â DANS PANIER */
function changeQty(idx,delta){
cart[idx].qty+=delta;
if(cart[idx].qty<1) cart[idx].qty=1;
openCart();
}

function changeQtyInput(idx,val){
cart[idx].qty=parseInt(val);
if(cart[idx].qty<1) cart[idx].qty=1;
openCart();
}

/* SUPPRIMER AVEC CONFIRMATION */
function confirmRemove(i){
Swal.fire({
title:'Supprimer ce produit ?',
icon:'warning',
showCancelButton:true,
confirmButtonText:'Oui',
cancelButtonText:'Non'
}).then((result)=>{
if(result.isConfirmed){
cart.splice(i,1);
updateBadge();
openCart();
}
});
}

/* METTRE A JOUR TOTAL */
function updateTotal(){
let l=parseInt(document.getElementById('livraison').value);
let t=cart.reduce((a,b)=>a+b.price*b.qty,0)+l;
document.getElementById('total').innerText=t;
}

/* ENVOYER COMMANDE WHATSAPP */
function sendOrder(){
let nom=document.getElementById('nom').value.trim();
let adr=document.getElementById('adresse').value.trim();
let tel=document.getElementById('tel').value.trim();
let comment=document.getElementById('comment').value.trim();
if(!nom||!adr||!tel){
Swal.showValidationMessage('Champs obligatoires');
return false;
}

let total=parseInt(document.getElementById('total').innerText);
let livraison=parseInt(document.getElementById('livraison').value);

let msg="Commande:%0A";
cart.forEach(i=>{
msg+=`${i.name} x${i.qty} = ${i.price*i.qty} DH%0A`;
});
msg+=`Livraison: ${livraison==0?'Sans':'Avec'}%0A`;
msg+=`Total: ${total} DH%0A`;
msg+=`Nom: ${nom}%0AAdresse: ${adr}%0ATel: ${tel}%0A`;
if(comment) msg+=`Commentaire: ${comment}%0A`;

window.open(`https://wa.me/212661906684?text=${msg}`,"_blank");

cart=[];
updateBadge();
Swal.fire('Merci üôè','Commande envoy√©e','success');
renderProducts();
}

renderProducts();
</script>

</body>
</html>
